<!DOCTYPE html>  <html> <head>   <title>cryptastic.inc.php</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="buckets.inc-011212.html">                 buckets.inc-011212.php               </a>                                           <a class="source" href="buckets.inc-120111.html">                 buckets.inc-120111.php               </a>                                           <a class="source" href="buckets.inc.html">                 buckets.inc.php               </a>                                           <a class="source" href="coda.inc-110311.html">                 coda.inc-110311.php               </a>                                           <a class="source" href="coda.inc.html">                 coda.inc.php               </a>                                           <a class="source" href="coverflow.inc-120511.html">                 coverflow.inc-120511.php               </a>                                           <a class="source" href="coverflow.inc.html">                 coverflow.inc.php               </a>                                           <a class="source" href="cryptastic.inc.html">                 cryptastic.inc.php               </a>                                           <a class="source" href="elements.inc-113011.html">                 elements.inc-113011.php               </a>                                           <a class="source" href="elements.inc.html">                 elements.inc.php               </a>                                           <a class="source" href="form.inc.html">                 form.inc.php               </a>                                           <a class="source" href="index.html">                 index.php               </a>                                           <a class="source" href="menus.inc-041212.html">                 menus.inc-041212.php               </a>                                           <a class="source" href="menus.inc-120611.html">                 menus.inc-120611.php               </a>                                           <a class="source" href="menus.inc.html">                 menus.inc.php               </a>                                           <a class="source" href="page.inc-110211.html">                 page.inc-110211.php               </a>                                           <a class="source" href="page.inc.html">                 page.inc.php               </a>                                           <a class="source" href="product.inc.html">                 product.inc.php               </a>                                           <a class="source" href="settings.inc-110311.html">                 settings.inc-110311.php               </a>                                           <a class="source" href="settings.inc.html">                 settings.inc.php               </a>                                           <a class="source" href="slide.inc-110311.html">                 slide.inc-110311.php               </a>                                           <a class="source" href="slide.inc.html">                 slide.inc.php               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               cryptastic.inc.php             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * Microsite Cryptastic Class</span>
<span class="sd"> *</span>
<span class="sd"> * @author HMH Web Team</span>
<span class="sd"> * @author Bryan Schultz bryan.schultz@hmhpub.com</span>
<span class="sd"> * @author Terence Bodola terence.bodola@hmhpub.com</span>
<span class="sd"> * @author Kyle Crawford kyle.crawford@hmhpub.com</span>
<span class="sd"> * @author Seth Cardoza seth.cardoza@hmhpub.com</span>
<span class="sd"> * @author Chris Cykana christopher.cykana@hmhpub.com</span>
<span class="sd"> *</span>
<span class="sd"> * @copyright Copyright (c) 1995-2011 Houghton Mifflin Harcourt. All rights reserved.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * @package Microsite System Templates</span>
<span class="sd"> * @subpackage System/Classes</span>
<span class="sd"> * @since Microsite 2.0.0</span>
<span class="sd"> * @version 3.0.0 (honeybadger)</span>
<span class="sd"> */</span>
 
<span class="cm">/*</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm"> *  This class contains all the methods needed to construct the</span>
<span class="cm"> *  cryptastic object for a microsite.</span>
<span class="cm"> *</span>
<span class="cm"> *  Include Generalized Global functions</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm">*/</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>require_once <strong>FUNCT</strong>."/general.inc.php"; &lt;----uncomment for honeybadger, currently commented out for templates-1.0</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm"> *  CLASS CRYPTASTIC</span>
<span class="cm"> *  DEFAULT SETTINGS FOR METHODS ARE LOCATED AT</span>
<span class="cm"> *  system/application/localIncludes/cryptastic.php</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm">    Cryptastic, by Andrew Johnson (2009).</span>
<span class="cm">    http://www.itnewb.com/user/Andrew</span>
<span class="cm">    </span>
<span class="cm">    ~implemented by Kyle Crawford~</span>

<span class="cm">    You are free to use this code for personal/business use,</span>
<span class="cm">    without attribution, although it would be appreciated.</span>

<span class="cm">-----------------------------------------------------------------------</span>

<span class="cm">    CAUTION, CAUTION, CAUTION! USE AT YOUR OWN RISK!</span>

<span class="cm">    It&#39;s your duty to use good passwords, salts and keys; and come up</span>
<span class="cm">    with an adequately safe techinque to store and access them.</span>
<span class="cm">    </span>
<span class="cm">    HOW TO IMPLEMENT THE CRYPTASTIC METHODS -</span>
<span class="cm">    The below example uses JQuery .ajax() method with a GET instance</span>
<span class="cm">    </span>
<span class="cm">    EXAMPLE: refer to /tx/senderos/localIncludes/pdf-farm.php for client side implementation</span>
<span class="cm">    (Client Side)</span>
<span class="cm">    $pass = &#39;H0ught0nMIfLynHArKoRt&#39;;</span>
<span class="cm">    $salt = &#39;TxS3ndairOs&#39;;</span>
<span class="cm">    $key = $crypto-&gt;pbkdf2($pass, $salt, 1000, 32);</span>
<span class="cm">    $confirmCode = rawurlencode($crypto-&gt;encrypt(&quot;douNLoDe3dFs&quot;,$key));</span>
<span class="cm">    </span>
<span class="cm">    Then echo/print the $confirmCode where you need to use it</span>
<span class="cm">    </span>
<span class="cm">    EXAMPLE: refer to /tx/senderos/get-pdfs-query-2.php for server/query side implementation</span>
<span class="cm">    (Server/Query Side)</span>
<span class="cm">    </span>
<span class="cm">    if(isset($_GET[&#39;confirmCode&#39;]) {</span>
<span class="cm">      $confCode = $_GET[&#39;confirmCode&#39;]; </span>
<span class="cm">    }</span>
<span class="cm">    </span>
<span class="cm">    $pass = &#39;H0ught0nMIfLynHArKoRt&#39;;</span>
<span class="cm">    $salt = &#39;TxS3ndairOs&#39;;</span>
<span class="cm">    $key = $crypto-&gt;pbkdf2($pass, $salt, 1000, 32);</span>
<span class="cm">    $confirmCode = $crypto-&gt;decrypt(rawurldecode($confCode),$key);</span>
<span class="cm">    </span>
<span class="cm">    if($confirmCode == &quot;douNLoDe3dFs&quot;) {</span>

<span class="cm">//DIVIDER</span>
<span class="cm">    }</span>

<span class="cm">-------------------------------------------------------------------------*/</span>

  <span class="k">class</span> <span class="nc">cryptastic</span> <span class="p">{</span>
    
<span class="cm">/*</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm"> *  START METHODS</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm">*/</span>  </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>execute query...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">protected</span> <span class="nv">$version</span> <span class="o">=</span> <span class="s2">&quot;Microsite Bucket Version 3.0.0&quot;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Set the version number for the class
All classes should have this</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">private</span> <span class="k">function</span> <span class="nf">_getVersion</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">string</span><span class="p">)</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">__call</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="nv">$args</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;Missing method called : </span><span class="si">$name</span><span class="s2">, &quot;</span><span class="o">.</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="nv">$args</span><span class="p">);</span>
  <span class="p">}</span>
<span class="cm">/*</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm"> *  ERROR REPORTING</span>
<span class="cm"> *  @method: errorReport($bool)</span>
<span class="cm"> *</span>
<span class="cm"> *  @var $bool</span>
<span class="cm"> *  @param mixed $bool</span>
<span class="cm"> *  @var boolean params: false, FALSE, 0</span>
<span class="cm"> *  @var boolean params: true , TRUE , 1</span>
<span class="cm"> *  @var default param: 0</span>
<span class="cm"> *</span>
<span class="cm"> *  NOT REQUIRED</span>
<span class="cm">*/</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">errorReport</span><span class="p">(</span><span class="nv">$bool</span> <span class="o">=</span> <span class="k">NULL</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$input</span> <span class="o">=</span> <span class="nx">booleanCheck</span><span class="p">(</span><span class="nv">$bool</span><span class="p">);</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">reporter</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$input</span> <span class="o">!=</span> <span class="k">NULL</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="nv">$input</span> <span class="o">:</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">reporter</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_generateReport</span><span class="p">()</span> <span class="o">:</span> <span class="k">NULL</span><span class="p">;</span>
  <span class="p">}</span>
<span class="cm">/*</span>

<span class="cm">    /** Encryption Procedure</span>
<span class="cm">     *</span>
<span class="cm">     *  @param   mixed    msg      message/data</span>
<span class="cm">     *  @param   string   k        encryption key</span>
<span class="cm">     *  @param   boolean  base64   base64 encode result</span>
<span class="cm">     *</span>
<span class="cm">     *  @return  string   iv+ciphertext+mac or</span>
<span class="cm">     *           boolean  false on error</span>
<span class="cm">    */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">encrypt</span><span class="p">(</span> <span class="nv">$msg</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="nv">$base64</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>

      <span class="c1"># open cipher module (do not change cipher/mode)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$td</span> <span class="o">=</span> <span class="nb">mcrypt_module_open</span><span class="p">(</span><span class="s1">&#39;rijndael-256&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;ctr&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

      <span class="nv">$msg</span> <span class="o">=</span> <span class="nb">serialize</span><span class="p">(</span><span class="nv">$msg</span><span class="p">);</span>             <span class="c1"># serialize</span>
      <span class="nv">$iv</span>  <span class="o">=</span> <span class="nb">mcrypt_create_iv</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="nx">MCRYPT_RAND</span><span class="p">);</span>   <span class="c1"># create iv</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nb">mcrypt_generic_init</span><span class="p">(</span><span class="nv">$td</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="p">)</span>  <span class="c1"># initialize buffers</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

      <span class="nv">$msg</span>  <span class="o">=</span> <span class="nb">mcrypt_generic</span><span class="p">(</span><span class="nv">$td</span><span class="p">,</span> <span class="nv">$msg</span><span class="p">);</span>        <span class="c1"># encrypt</span>
      <span class="nv">$msg</span>  <span class="o">=</span> <span class="nv">$iv</span> <span class="o">.</span> <span class="nv">$msg</span><span class="p">;</span>               <span class="c1"># prepend iv</span>
      <span class="nv">$mac</span>  <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pbkdf2</span><span class="p">(</span><span class="nv">$msg</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>    <span class="c1"># create mac</span>
      <span class="nv">$msg</span> <span class="o">.=</span> <span class="nv">$mac</span><span class="p">;</span>                 <span class="c1"># append mac</span>

      <span class="nb">mcrypt_generic_deinit</span><span class="p">(</span><span class="nv">$td</span><span class="p">);</span>           <span class="c1"># clear buffers</span>
      <span class="nb">mcrypt_module_close</span><span class="p">(</span><span class="nv">$td</span><span class="p">);</span>           <span class="c1"># close cipher module</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nv">$base64</span> <span class="p">)</span> <span class="nv">$msg</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$msg</span><span class="p">);</span>    <span class="c1"># base64 encode?</span>

      <span class="k">return</span> <span class="nv">$msg</span><span class="p">;</span>                  <span class="c1"># return iv+ciphertext+mac</span>
    <span class="p">}</span>

    <span class="sd">/** Decryption Procedure</span>
<span class="sd">     *</span>
<span class="sd">     *  @param   string   msg      output from encrypt()</span>
<span class="sd">     *  @param   string   k        encryption key</span>
<span class="sd">     *  @param   boolean  base64   base64 decode msg</span>
<span class="sd">     *</span>
<span class="sd">     *  @return  string   original message/data or</span>
<span class="sd">     *           boolean  false on error</span>
<span class="sd">    */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">decrypt</span><span class="p">(</span> <span class="nv">$msg</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="nv">$base64</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span> <span class="p">{</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nv">$base64</span> <span class="p">)</span> <span class="nv">$msg</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$msg</span><span class="p">);</span>      <span class="c1"># base64 decode?</span>

      <span class="c1"># open cipher module (do not change cipher/mode)</span>
      <span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$td</span> <span class="o">=</span> <span class="nb">mcrypt_module_open</span><span class="p">(</span><span class="s1">&#39;rijndael-256&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;ctr&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

      <span class="nv">$iv</span>  <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$msg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>             <span class="c1"># extract iv</span>
      <span class="nv">$mo</span>  <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span> <span class="o">-</span> <span class="mi">32</span><span class="p">;</span>             <span class="c1"># mac offset</span>
      <span class="nv">$em</span>  <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$msg</span><span class="p">,</span> <span class="nv">$mo</span><span class="p">);</span>             <span class="c1"># extract mac</span>
      <span class="nv">$msg</span> <span class="o">=</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$msg</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$msg</span><span class="p">)</span><span class="o">-</span><span class="mi">64</span><span class="p">);</span>     <span class="c1"># extract ciphertext</span>
      <span class="nv">$mac</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pbkdf2</span><span class="p">(</span><span class="nv">$iv</span> <span class="o">.</span> <span class="nv">$msg</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">32</span><span class="p">);</span>   <span class="c1"># create mac</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nv">$em</span> <span class="o">!==</span> <span class="nv">$mac</span> <span class="p">)</span>                 <span class="c1"># authenticate mac</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

      <span class="k">if</span> <span class="p">(</span> <span class="nb">mcrypt_generic_init</span><span class="p">(</span><span class="nv">$td</span><span class="p">,</span> <span class="nv">$k</span><span class="p">,</span> <span class="nv">$iv</span><span class="p">)</span> <span class="o">!==</span> <span class="mi">0</span> <span class="p">)</span>    <span class="c1"># initialize buffers</span>
        <span class="k">return</span> <span class="k">false</span><span class="p">;</span>

      <span class="nv">$msg</span> <span class="o">=</span> <span class="nb">mdecrypt_generic</span><span class="p">(</span><span class="nv">$td</span><span class="p">,</span> <span class="nv">$msg</span><span class="p">);</span>         <span class="c1"># decrypt</span>
      <span class="nv">$msg</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nv">$msg</span><span class="p">);</span>             <span class="c1"># unserialize</span>

      <span class="nb">mcrypt_generic_deinit</span><span class="p">(</span><span class="nv">$td</span><span class="p">);</span>             <span class="c1"># clear buffers</span>
      <span class="nb">mcrypt_module_close</span><span class="p">(</span><span class="nv">$td</span><span class="p">);</span>             <span class="c1"># close cipher module</span>

      <span class="k">return</span> <span class="nv">$msg</span><span class="p">;</span>                    <span class="c1"># return original msg</span>
    <span class="p">}</span>

    <span class="sd">/** PBKDF2 Implementation (as described in RFC 2898);</span>
<span class="sd">     *</span>
<span class="sd">     *  @param   string  p   password</span>
<span class="sd">     *  @param   string  s   salt</span>
<span class="sd">     *  @param   int     c   iteration count (use 1000 or higher)</span>
<span class="sd">     *  @param   int     kl  derived key length</span>
<span class="sd">     *  @param   string  a   hash algorithm</span>
<span class="sd">     *</span>
<span class="sd">     *  @return  string  derived key</span>
<span class="sd">    */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">pbkdf2</span><span class="p">(</span> <span class="nv">$p</span><span class="p">,</span> <span class="nv">$s</span><span class="p">,</span> <span class="nv">$c</span><span class="p">,</span> <span class="nv">$kl</span><span class="p">,</span> <span class="nv">$a</span> <span class="o">=</span> <span class="s1">&#39;sha256&#39;</span> <span class="p">)</span> <span class="p">{</span>

      <span class="nv">$hl</span> <span class="o">=</span> <span class="nb">strlen</span><span class="p">(</span><span class="nb">hash</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">true</span><span class="p">));</span> <span class="c1"># Hash length</span>
      <span class="nv">$kb</span> <span class="o">=</span> <span class="nb">ceil</span><span class="p">(</span><span class="nv">$kl</span> <span class="o">/</span> <span class="nv">$hl</span><span class="p">);</span>        <span class="c1"># Key blocks to compute</span>
      <span class="nv">$dk</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>             <span class="c1"># Derived key</span>

      <span class="c1"># Create key</span>
      <span class="k">for</span> <span class="p">(</span> <span class="nv">$block</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$block</span> <span class="o">&lt;=</span> <span class="nv">$kb</span><span class="p">;</span> <span class="nv">$block</span> <span class="o">++</span> <span class="p">)</span> <span class="p">{</span>

        <span class="c1"># Initial hash for this block</span>
        <span class="nv">$ib</span> <span class="o">=</span> <span class="nv">$b</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$s</span> <span class="o">.</span> <span class="nb">pack</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="nv">$block</span><span class="p">),</span> <span class="nv">$p</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

        <span class="c1"># Perform block iterations</span>
        <span class="k">for</span> <span class="p">(</span> <span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nv">$c</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">++</span> <span class="p">)</span> 

          <span class="c1"># XOR each iterate</span>
          <span class="nv">$ib</span> <span class="o">^=</span> <span class="p">(</span><span class="nv">$b</span> <span class="o">=</span> <span class="nb">hash_hmac</span><span class="p">(</span><span class="nv">$a</span><span class="p">,</span> <span class="nv">$b</span><span class="p">,</span> <span class="nv">$p</span><span class="p">,</span> <span class="k">true</span><span class="p">));</span>

        <span class="nv">$dk</span> <span class="o">.=</span> <span class="nv">$ib</span><span class="p">;</span> <span class="c1"># Append iterated block</span>
      <span class="p">}</span>

      <span class="c1"># Return derived key of correct length</span>
      <span class="k">return</span> <span class="nx">substr</span><span class="p">(</span><span class="nv">$dk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">$kl</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="k">private</span> <span class="k">function</span> <span class="nf">_generateReport</span><span class="p">()</span> <span class="p">{</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t</span><span class="s2">&lt;h1&gt;&lt;em&gt;&lt;em&gt;Cryptastic Values&lt;/em&gt;&lt;/em&gt;&lt;/h1&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t</span><span class="s2">&lt;ul&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t\t</span><span class="s2">&lt;li&gt;&lt;em&gt;&lt;em&gt;Version:&lt;/em&gt;&lt;/em&gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ltrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">version</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t\t</span><span class="s2">&lt;li&gt;&lt;em&gt;&lt;em&gt;bucketCount:&lt;/em&gt;&lt;/em&gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ltrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">encrypt</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t\t</span><span class="s2">&lt;li&gt;&lt;em&gt;&lt;em&gt;bucketCount:&lt;/em&gt;&lt;/em&gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ltrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">decrypt</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span> <span class="s2">&quot;</span><span class="se">\r\n\t\t\t\t</span><span class="s2">&lt;li&gt;&lt;em&gt;&lt;em&gt;bucketCount:&lt;/em&gt;&lt;/em&gt; &quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">ltrim</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">pbkdf2</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&lt;/li&gt;&quot;</span><span class="p">;</span>
      <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span> <span class="o">.=</span>  <span class="s2">&quot;</span><span class="se">\r\n\t\t\t</span><span class="s2">&lt;/ul&gt;&quot;</span><span class="p">;</span>
      <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">report</span><span class="p">;</span>   
    <span class="p">}</span>   
<span class="cm">/*</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm"> *  END METHODS</span>
<span class="cm"> ***************************************************************************</span>
<span class="cm">*/</span>
<span class="p">}</span>
<span class="cm">/* End of file cryptastic.inc.php */</span>
<span class="cm">/* Location: system/classes/cryptastic.inc.php */</span>
<span class="cp">?&gt;</span><span class="x"></span>

</pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Return the version of the class</p>             </td>             <td class="code">               <div class="highlight"><pre>undefined</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 